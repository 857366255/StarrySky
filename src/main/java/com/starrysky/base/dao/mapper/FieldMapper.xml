<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.starrysky.base.dao.FieldDao">
    <!--映射实体类-->
    <sql id="select_from" > SELECT id, table_name, name, id_name,type,size,type_size,is_null FROM s_field </sql>
    <resultMap id="classesResultMap" type="com.starrysky.base.po.Field">
        <id property="id" column="id"/>
        <result property="tableName" column="table_name"/>
        <result property="name" column="name"/>
        <result property="idName" column="id_name"/>
        <result property="type" column="type"/>
        <result property="size" column="size"/>
        <result property="typeSize" column="type_size"/>
        <result property="isNull" column="is_null"/>
    </resultMap>
    <!--增加-->
    <insert id="doCreate" parameterType="com.starrysky.base.po.Field">
        INSERT INTO s_field
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="tableName != null">table_name,</if>
            <if test="name != null">name,</if>
            <if test="idName != null">id_name,</if>
            <if test="type != null">type,</if>
            <if test="size != null">size,</if>
            <if test="typeSize != null">type_size,</if>
            <if test="isNull != null">is_null,</if>
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id},</if>
            <if test="tableName != null">#{tableName},</if>
            <if test="name != null">#{name},</if>
            <if test="idName != null">#{idName},</if>
            <if test="type != null">#{type},</if>
            <if test="size != null">#{size},</if>
            <if test="typeSize != null">#{typeSize},</if>
            <if test="isNull != null">#{isNull},</if>
        </trim>
    </insert>
    <!--批量删除-->
    <delete id="doRemoveBatch" parameterType="java.util.List">
        DELETE FROM s_field
        <where>
            <choose>
                <when test="list != null and list.size()!=0">
                    id IN
                    <foreach collection="list" item="item" open="(" separator="," close=")">
                        '${item}'
                    </foreach>
                </when >
                <otherwise>
                    1=2
                </otherwise>
            </choose>
        </where>
    </delete>
    <!--删除-->
    <delete id="doRemove" parameterType="int">
        DELETE FROM s_field WHERE id = #{id}
    </delete>
    <!--更新-->
    <update id="doUpdate" parameterType="com.starrysky.base.po.Field">
        UPDATE s_field
        <trim prefix="SET" suffixOverrides=",">
            <!--<if test="id != null">id=#{id},</if>-->
            <if test="tableName != null">table_name=#{tableName},</if>
            <if test="name != null">name=#{name},</if>
            <if test="idName != null">id_name=#{idName},</if>
            <if test="type != null">type=#{type},</if>
            <if test="size != null">size=#{size},</if>
            <if test="typeSize != null">type_size=#{typeSize},</if>
            <if test="isNull != null">is_null=#{isNull},</if>
        </trim>
        WHERE
        <choose>
            <when test="id !=null ">
                id=#{id}
            </when >
            <otherwise>
                1=2
            </otherwise>
        </choose>
    </update>
    <!--查询全部数据-->
    <select id="findAll" resultMap="classesResultMap">
        <include refid="select_from" />
    </select>
    <!--按id查询数据-->
    <select id="findById" parameterType="int" resultMap="classesResultMap">
        <include refid="select_from" /> WHERE id=#{id}
    </select>
    <!--按条件查询-->
    <!--<select id="findByCondition" parameterMap="java.util.Map" resultMap="java.util.Map">
        <include refid="select_from" />
        <where>
            <foreach collection="find" index="index" item="item" separator="AND " >
                <if test="item != null">${index}=#{item}</if>
            </foreach>
        </where>
    </select>-->

    <resultMap id="databaseFieldMap" type="com.starrysky.base.po.Field">
        <id property="id" column="id"/>
        <result property="tableName" column="table_name"/>
        <result property="name" column="column_comment"/>
        <result property="idName" column="column_name"/>
        <result property="type" column="data_type"/>
        <!--<result property="size" column="size"/>-->
        <result property="typeSize" column="column_type"/>
        <result property="isNull" column="is_nullable"/>
    </resultMap>
    <select id="getDatabaseField" resultMap="databaseFieldMap">
        CALL get_database_field()
    </select>

</mapper>